<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔒 Sistema de Acesso Seguro - Roleplay</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --police-color: #2c3e50;
            --detran-color: #2980b9;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .auth-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }
        
        .btn-police {
            background-color: var(--police-color);
            color: white;
        }
        
        .btn-detran {
            background-color: var(--detran-color);
            color: white;
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .main-content {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        
        .sidebar {
            flex: 1;
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .content {
            flex: 3;
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-left: 4px solid var(--secondary-color);
        }
        
        .card-police {
            border-left-color: var(--police-color);
        }
        
        .card-detran {
            border-left-color: var(--detran-color);
        }
        
        .card-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .feature-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background-color: var(--light-color);
            border-radius: 6px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-wide {
            max-width: 800px;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--dark-color);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: var(--light-color);
            font-weight: 600;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-active {
            background-color: rgba(39, 174, 96, 0.2);
            color: var(--success-color);
        }
        
        .status-inactive {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger-color);
        }
        
        .status-warning {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning-color);
        }
        
        .admin-panel, .police-panel, .detran-panel {
            display: none;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .panel-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .panel-selector button {
            flex: 1;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .dashboard-item {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .dashboard-item h3 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .dashboard-item p {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .vehicle-card {
            display: flex;
            background-color: var(--light-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            align-items: center;
            gap: 15px;
        }
        
        .vehicle-photo {
            width: 100px;
            height: 80px;
            border-radius: 8px;
            background-color: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #777;
            font-size: 0.8rem;
            text-align: center;
        }
        
        .vehicle-info {
            flex: 1;
        }
        
        .vehicle-plate {
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .vehicle-details {
            display: flex;
            gap: 15px;
            margin-top: 5px;
            font-size: 0.9rem;
            color: #555;
        }
        
        .vehicle-actions {
            display: flex;
            gap: 10px;
        }
        
        .expiry-info {
            margin-top: 5px;
            font-size: 0.8rem;
        }
        
        .expiry-warning {
            color: var(--warning-color);
            font-weight: bold;
        }
        
        .expiry-danger {
            color: var(--danger-color);
            font-weight: bold;
        }
        
        footer {
            margin-top: 40px;
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            border-top: 1px solid #ddd;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .features {
                grid-template-columns: 1fr;
            }
            
            .panel-selector {
                flex-direction: column;
            }
            
            .dashboard {
                grid-template-columns: 1fr 1fr;
            }
            
            .vehicle-card {
                flex-direction: column;
                text-align: center;
            }
            
            .vehicle-details {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <span>🔒</span>
                    <span>Sistema de Acesso Seguro - Roleplay</span>
                </div>
                <div class="auth-section">
                    <div class="user-info" id="userInfo" style="display: none;">
                        <div class="avatar" id="userAvatar">U</div>
                        <span id="userName">Usuário</span>
                    </div>
                    <button class="btn btn-primary" id="loginBtn">Login</button>
                    <button class="btn btn-danger" id="logoutBtn" style="display: none;">Logout</button>
                </div>
            </div>
        </div>
    </header>
    
    <div class="container">
        <div class="main-content">
            <div class="sidebar">
                <h3>Painel de Controle</h3>
                <div class="card">
                    <div class="card-title">Status do Sistema</div>
                    <p>Sistema de autenticação ativo</p>
                    <p>Controle de acesso por órgão</p>
                    <p>Auditoria de logins habilitada</p>
                </div>
                
                <div class="card">
                    <div class="card-title">Acesso Rápido</div>
                    <div class="panel-selector">
                        <button class="btn btn-primary" id="adminPanelBtn" style="display: none;">Administrativo</button>
                        <button class="btn btn-police" id="policePanelBtn" style="display: none;">Policial</button>
                        <button class="btn btn-detran" id="detranPanelBtn" style="display: none;">Detran</button>
                    </div>
                    <button class="btn btn-success" style="width: 100%;">Relatório de Acessos</button>
                </div>
            </div>
            
            <div class="content">
                <h2>Bem-vindo ao Sistema de Acesso Seguro - Roleplay</h2>
                <p>Este sistema requer autenticação para acessar os recursos. Apenas usuários registrados podem utilizar as funcionalidades.</p>
                
                <div class="features">
                    <div class="feature-item">
                        <span>✅</span>
                        <span>Apenas usuários registrados</span>
                    </div>
                    <div class="feature-item">
                        <span>✅</span>
                        <span>Autenticação obrigatória</span>
                    </div>
                    <div class="feature-item">
                        <span>✅</span>
                        <span>Controle de acesso por órgão</span>
                    </div>
                    <div class="feature-item">
                        <span>✅</span>
                        <span>Auditoria de logins</span>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-title">👮‍♂️ Acesso Administrativo</div>
                    <p>Para cadastrar novos usuários, utilize as credenciais de administrador.</p>
                    <p>Credenciais padrão do administrador:</p>
                    <ul>
                        <li>Usuário: <strong>admin</strong></li>
                        <li>Senha: <strong>admin123</strong></li>
                    </ul>
                </div>
                
                <!-- Painel Administrativo (visível apenas para administradores) -->
                <div class="admin-panel" id="adminPanel">
                    <div class="card">
                        <div class="card-title">👮‍♂️ Painel Administrativo</div>
                        <p>Gerencie usuários e permissões do sistema.</p>
                        
                        <button class="btn btn-success" id="addUserBtn">Adicionar Usuário</button>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Usuário</th>
                                    <th>Órgão</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="usersTable">
                                <!-- Dados dos usuários serão inseridos aqui via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">Auditoria de Logins</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Usuário</th>
                                    <th>Data/Hora</th>
                                    <th>IP</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="auditTable">
                                <!-- Dados de auditoria serão inseridos aqui via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Painel Policial -->
                <div class="police-panel" id="policePanel">
                    <div class="card card-police">
                        <div class="card-title">👮‍♂️ Painel Policial</div>
                        <p>Sistema de consultas e registros policiais.</p>
                        
                        <div class="dashboard">
                            <div class="dashboard-item">
                                <h3 id="totalIndividuals">0</h3>
                                <p>Indivíduos Cadastrados</p>
                            </div>
                            <div class="dashboard-item">
                                <h3 id="totalArrests">0</h3>
                                <p>Prisões Realizadas</p>
                            </div>
                            <div class="dashboard-item">
                                <h3>7</h3>
                                <p>Veículos Apreendidos</p>
                            </div>
                            <div class="dashboard-item">
                                <h3>156</h3>
                                <p>Consultas Realizadas</p>
                            </div>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-police" id="addIndividualBtn">Cadastrar Indivíduo</button>
                            <button class="btn btn-police">Consultar CPF</button>
                            <button class="btn btn-police">Consultar Veículo</button>
                            <button class="btn btn-police">Registrar Ocorrência</button>
                            <button class="btn btn-police">Emitir Mandado</button>
                            <button class="btn btn-police">Consultar Antecedentes</button>
                        </div>
                        
                        <h3 style="margin-top: 20px;">Indivíduos Cadastrados</h3>
                        <div id="individualsList">
                            <!-- Lista de indivíduos será inserida aqui via JavaScript -->
                        </div>
                    </div>
                </div>
                
                <!-- Painel Detran -->
                <div class="detran-panel" id="detranPanel">
                    <div class="card card-detran">
                        <div class="card-title">🚗 Painel Detran</div>
                        <p>Sistema de registro e consulta de veículos.</p>
                        
                        <div class="dashboard">
                            <div class="dashboard-item">
                                <h3 id="totalVehicles">0</h3>
                                <p>Veículos Registrados</p>
                            </div>
                            <div class="dashboard-item">
                                <h3 id="pendingVehicles">0</h3>
                                <p>Pendentes de Regularização</p>
                            </div>
                            <div class="dashboard-item">
                                <h3 id="expiredVehicles">0</h3>
                                <p>Com Prazo Expirado</p>
                            </div>
                            <div class="dashboard-item">
                                <h3 id="regularizedVehicles">0</h3>
                                <p>Regularizados</p>
                            </div>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-detran" id="addVehicleBtn">Registrar Veículo</button>
                            <button class="btn btn-detran" id="consultPlateBtn">Consultar Placa</button>
                        </div>
                        
                        <h3 style="margin-top: 20px;">Veículos Registrados</h3>
                        <div id="vehiclesList">
                            <!-- Lista de veículos será inserida aqui via JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de Login -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Login no Sistema</h3>
                <button class="close-modal" id="closeLoginModal">&times;</button>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Usuário</label>
                    <input type="text" id="username" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha</label>
                    <input type="password" id="password" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Entrar</button>
            </form>
        </div>
    </div>
    
    <!-- Modal de Adicionar Usuário -->
    <div class="modal" id="addUserModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Adicionar Novo Usuário</h3>
                <button class="close-modal" id="closeAddUserModal">&times;</button>
            </div>
            <form id="addUserForm">
                <div class="form-group">
                    <label for="newUserName">Nome Completo</label>
                    <input type="text" id="newUserName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newUserUsername">Nome de Usuário</label>
                    <input type="text" id="newUserUsername" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newUserPassword">Senha</label>
                    <input type="password" id="newUserPassword" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newUserOrg">Órgão</label>
                    <select id="newUserOrg" class="form-control" required>
                        <option value="">Selecione um órgão</option>
                        <option value="Policial">Policial</option>
                        <option value="Detran">Detran</option>
                        <option value="Administrativo">Administrativo</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newUserRole">Tipo de Usuário</label>
                    <select id="newUserRole" class="form-control" required>
                        <option value="user">Usuário Padrão</option>
                        <option value="admin">Administrador</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-success" style="width: 100%;">Cadastrar Usuário</button>
            </form>
        </div>
    </div>
    
    <!-- Modal de Cadastrar Indivíduo -->
    <div class="modal" id="addIndividualModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Cadastrar Indivíduo</h3>
                <button class="close-modal" id="closeAddIndividualModal">&times;</button>
            </div>
            <form id="addIndividualForm">
                <div class="form-group">
                    <label for="individualName">Nome</label>
                    <input type="text" id="individualName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="individualLastName">Sobrenome</label>
                    <input type="text" id="individualLastName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="individualCPF">CPF</label>
                    <input type="text" id="individualCPF" class="form-control" placeholder="000.000.000-00" required>
                </div>
                <div class="form-group">
                    <label for="individualPhoto">Foto (URL)</label>
                    <input type="text" id="individualPhoto" class="form-control" placeholder="https://exemplo.com/foto.jpg">
                    <div class="photo-preview" id="photoPreview">Pré-visualização da foto</div>
                </div>
                <div class="form-group">
                    <label for="individualPenalArticle">Artigo Penal</label>
                    <input type="text" id="individualPenalArticle" class="form-control" placeholder="Ex: Art. 157 - Roubo" required>
                </div>
                <div class="form-group">
                    <label for="individualPrisonTime">Tempo de Prisão</label>
                    <input type="text" id="individualPrisonTime" class="form-control" placeholder="Ex: 5 anos" required>
                </div>
                <button type="submit" class="btn btn-success" style="width: 100%;">Cadastrar Indivíduo</button>
            </form>
        </div>
    </div>
    
    <!-- Modal de Visualizar Indivíduo -->
    <div class="modal" id="viewIndividualModal">
        <div class="modal-content modal-wide">
            <div class="modal-header">
                <h3>Informações do Indivíduo</h3>
                <button class="close-modal" id="closeViewIndividualModal">&times;</button>
            </div>
            <div id="individualDetails">
                <!-- Detalhes do indivíduo serão inseridos aqui via JavaScript -->
            </div>
        </div>
    </div>
    
    <!-- Modal de Registrar Veículo -->
    <div class="modal" id="addVehicleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Registrar Veículo</h3>
                <button class="close-modal" id="closeAddVehicleModal">&times;</button>
            </div>
            <form id="addVehicleForm">
                <div class="form-group">
                    <label for="vehiclePlate">Placa</label>
                    <input type="text" id="vehiclePlate" class="form-control" placeholder="ABC-1234" required>
                </div>
                <div class="form-group">
                    <label for="vehicleOwner">Proprietário</label>
                    <input type="text" id="vehicleOwner" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="vehicleModel">Modelo</label>
                    <input type="text" id="vehicleModel" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="vehicleColor">Cor</label>
                    <input type="text" id="vehicleColor" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="vehicleYear">Ano</label>
                    <input type="number" id="vehicleYear" class="form-control" min="1900" max="2030" required>
                </div>
                <div class="form-group">
                    <label for="vehiclePhoto">Foto (URL)</label>
                    <input type="text" id="vehiclePhoto" class="form-control" placeholder="https://exemplo.com/veiculo.jpg">
                </div>
                <div class="form-group">
                    <label for="vehicleReason">Motivo da Restrição</label>
                    <select id="vehicleReason" class="form-control" required>
                        <option value="">Selecione o motivo</option>
                        <option value="Documentação irregular">Documentação irregular</option>
                        <option value="Multas pendentes">Multas pendentes</option>
                        <option value="Roubo">Roubo</option>
                        <option value="Licenciamento atrasado">Licenciamento atrasado</option>
                        <option value="Outro">Outro</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-success" style="width: 100%;">Registrar Veículo</button>
            </form>
        </div>
    </div>
    
    <!-- Modal de Consultar Placa -->
    <div class="modal" id="consultPlateModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Consultar Placa</h3>
                <button class="close-modal" id="closeConsultPlateModal">&times;</button>
            </div>
            <form id="consultPlateForm">
                <div class="form-group">
                    <label for="searchPlate">Placa do Veículo</label>
                    <input type="text" id="searchPlate" class="form-control" placeholder="ABC-1234" required>
                </div>
                <button type="submit" class="btn btn-detran" style="width: 100%;">Consultar</button>
            </form>
            <div id="plateResult" style="margin-top: 20px;"></div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>Sistema de Acesso Seguro - Roleplay &copy; 2023 - Todos os direitos reservados</p>
        </div>
    </footer>
    
    <script>
        // Dados de exemplo (em um sistema real, isso viria de um backend)
        let users = [
            { id: 1, name: "Administrador", username: "admin", password: "admin123", org: "Administrativo", role: "admin", active: true },
            { id: 2, name: "Oficial João Silva", username: "joao.pm", password: "123456", org: "Policial", role: "user", active: true },
            { id: 3, name: "Agente Maria Santos", username: "maria.detran", password: "123456", org: "Detran", role: "user", active: true }
        ];
        
        let auditLogs = [
            { id: 1, username: "admin", timestamp: "2023-10-15 09:30:25", ip: "192.168.1.100", status: "Sucesso" },
            { id: 2, username: "joao.pm", timestamp: "2023-10-15 10:15:42", ip: "192.168.1.105", status: "Sucesso" },
            { id: 3, username: "maria.detran", timestamp: "2023-10-15 11:05:18", ip: "192.168.1.110", status: "Sucesso" },
            { id: 4, username: "usuario.invalido", timestamp: "2023-10-15 12:20:33", ip: "192.168.1.120", status: "Falha" }
        ];
        
        let individuals = [
            {
                id: 1,
                name: "Carlos",
                lastName: "Santana",
                cpf: "123.456.789-00",
                photo: "",
                penalArticle: "Art. 157 - Roubo",
                prisonTime: "5 anos",
                criminalRecords: [
                    { date: "15/10/2022", description: "Roubo a mão armada - Condenado a 5 anos" },
                    { date: "10/03/2020", description: "Porte ilegal de arma - Condenado a 2 anos" }
                ],
                arrests: 2
            },
            {
                id: 2,
                name: "Roberto",
                lastName: "Almeida",
                cpf: "987.654.321-00",
                photo: "",
                penalArticle: "Art. 121 - Homicídio",
                prisonTime: "12 anos",
                criminalRecords: [
                    { date: "22/08/2023", description: "Homicídio qualificado - Condenado a 12 anos" }
                ],
                arrests: 1
            }
        ];
        
        let vehicles = [
            {
                id: 1,
                plate: "ABC-1234",
                owner: "João Silva",
                model: "Fiat Uno",
                color: "Vermelho",
                year: 2018,
                photo: "",
                reason: "Documentação irregular",
                registrationDate: new Date(),
                expiryDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000), // 7 dias a partir de hoje
                regularized: false
            },
            {
                id: 2,
                plate: "XYZ-5678",
                owner: "Maria Santos",
                model: "Volkswagen Gol",
                color: "Preto",
                year: 2020,
                photo: "",
                reason: "Multas pendentes",
                registrationDate: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000), // 3 dias atrás
                expiryDate: new Date(Date.now() + 4 * 24 * 60 * 60 * 1000), // 4 dias a partir de hoje
                regularized: false
            },
            {
                id: 3,
                plate: "DEF-9012",
                owner: "Pedro Oliveira",
                model: "Chevrolet Onix",
                color: "Branco",
                year: 2022,
                photo: "",
                reason: "Licenciamento atrasado",
                registrationDate: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000), // 10 dias atrás
                expiryDate: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000), // 3 dias atrás (expirado)
                regularized: false
            }
        ];
        
        let currentUser = null;
        let currentPanel = null;
        
        // Elementos DOM
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const loginModal = document.getElementById('loginModal');
        const closeLoginModal = document.getElementById('closeLoginModal');
        const loginForm = document.getElementById('loginForm');
        const userInfo = document.getElementById('userInfo');
        const userName = document.getElementById('userName');
        const userAvatar = document.getElementById('userAvatar');
        const adminPanelBtn = document.getElementById('adminPanelBtn');
        const policePanelBtn = document.getElementById('policePanelBtn');
        const detranPanelBtn = document.getElementById('detranPanelBtn');
        const adminPanel = document.getElementById('adminPanel');
        const policePanel = document.getElementById('policePanel');
        const detranPanel = document.getElementById('detranPanel');
        const addUserBtn = document.getElementById('addUserBtn');
        const addUserModal = document.getElementById('addUserModal');
        const closeAddUserModal = document.getElementById('closeAddUserModal');
        const addUserForm = document.getElementById('addUserForm');
        const usersTable = document.getElementById('usersTable');
        const auditTable = document.getElementById('auditTable');
        const addIndividualBtn = document.getElementById('addIndividualBtn');
        const addIndividualModal = document.getElementById('addIndividualModal');
        const closeAddIndividualModal = document.getElementById('closeAddIndividualModal');
        const addIndividualForm = document.getElementById('addIndividualForm');
        const individualsList = document.getElementById('individualsList');
        const viewIndividualModal = document.getElementById('viewIndividualModal');
        const closeViewIndividualModal = document.getElementById('closeViewIndividualModal');
        const individualDetails = document.getElementById('individualDetails');
        const totalIndividuals = document.getElementById('totalIndividuals');
        const totalArrests = document.getElementById('totalArrests');
        const photoPreview = document.getElementById('photoPreview');
        const individualPhoto = document.getElementById('individualPhoto');
        const addVehicleBtn = document.getElementById('addVehicleBtn');
        const addVehicleModal = document.getElementById('addVehicleModal');
        const closeAddVehicleModal = document.getElementById('closeAddVehicleModal');
        const addVehicleForm = document.getElementById('addVehicleForm');
        const vehiclesList = document.getElementById('vehiclesList');
        const totalVehicles = document.getElementById('totalVehicles');
        const pendingVehicles = document.getElementById('pendingVehicles');
        const expiredVehicles = document.getElementById('expiredVehicles');
        const regularizedVehicles = document.getElementById('regularizedVehicles');
        const consultPlateBtn = document.getElementById('consultPlateBtn');
        const consultPlateModal = document.getElementById('consultPlateModal');
        const closeConsultPlateModal = document.getElementById('closeConsultPlateModal');
        const consultPlateForm = document.getElementById('consultPlateForm');
        const plateResult = document.getElementById('plateResult');
        
        // Event Listeners
        loginBtn.addEventListener('click', () => {
            loginModal.style.display = 'flex';
        });
        
        closeLoginModal.addEventListener('click', () => {
            loginModal.style.display = 'none';
        });
        
        logoutBtn.addEventListener('click', logout);
        
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            login(username, password);
        });
        
        adminPanelBtn.addEventListener('click', () => {
            showPanel('admin');
        });
        
        policePanelBtn.addEventListener('click', () => {
            showPanel('police');
        });
        
        detranPanelBtn.addEventListener('click', () => {
            showPanel('detran');
        });
        
        addUserBtn.addEventListener('click', () => {
            addUserModal.style.display = 'flex';
        });
        
        closeAddUserModal.addEventListener('click', () => {
            addUserModal.style.display = 'none';
        });
        
        addUserForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addNewUser();
        });
        
        addIndividualBtn.addEventListener('click', () => {
            addIndividualModal.style.display = 'flex';
        });
        
        closeAddIndividualModal.addEventListener('click', () => {
            addIndividualModal.style.display = 'none';
        });
        
        addIndividualForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addNewIndividual();
        });
        
        closeViewIndividualModal.addEventListener('click', () => {
            viewIndividualModal.style.display = 'none';
        });
        
        individualPhoto.addEventListener('input', () => {
            const url = individualPhoto.value;
            if (url) {
                photoPreview.innerHTML = `<img src="${url}" alt="Preview" style="width:100%; height:100%; object-fit:cover; border-radius:8px;">`;
            } else {
                photoPreview.textContent = "Pré-visualização da foto";
            }
        });
        
        addVehicleBtn.addEventListener('click', () => {
            addVehicleModal.style.display = 'flex';
        });
        
        closeAddVehicleModal.addEventListener('click', () => {
            addVehicleModal.style.display = 'none';
        });
        
        addVehicleForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addNewVehicle();
        });
        
        consultPlateBtn.addEventListener('click', () => {
            consultPlateModal.style.display = 'flex';
        });
        
        closeConsultPlateModal.addEventListener('click', () => {
            consultPlateModal.style.display = 'none';
            plateResult.innerHTML = '';
        });
        
        consultPlateForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const plate = document.getElementById('searchPlate').value;
            searchVehicle(plate);
        });
        
        // Funções
        function login(username, password) {
            const user = users.find(u => u.username === username && u.password === password && u.active);
            
            if (user) {
                currentUser = user;
                updateUI();
                loginModal.style.display = 'none';
                
                // Mostrar o painel correspondente ao órgão do usuário
                if (user.org === "Policial") {
                    showPanel('police');
                } else if (user.org === "Detran") {
                    showPanel('detran');
                } else if (user.role === "admin") {
                    showPanel('admin');
                }
                
                // Adicionar log de auditoria
                const timestamp = new Date().toLocaleString('pt-BR');
                const ip = generateRandomIP();
                auditLogs.unshift({
                    id: auditLogs.length + 1,
                    username: user.username,
                    timestamp: timestamp,
                    ip: ip,
                    status: "Sucesso"
                });
                
                alert(`Login realizado com sucesso! Bem-vindo, ${user.name}`);
            } else {
                // Adicionar log de auditoria para tentativa falha
                const timestamp = new Date().toLocaleString('pt-BR');
                const ip = generateRandomIP();
                auditLogs.unshift({
                    id: auditLogs.length + 1,
                    username: username,
                    timestamp: timestamp,
                    ip: ip,
                    status: "Falha"
                });
                
                alert('Usuário ou senha incorretos!');
            }
        }
        
        function logout() {
            currentUser = null;
            currentPanel = null;
            updateUI();
            hideAllPanels();
            alert('Logout realizado com sucesso!');
        }
        
        function updateUI() {
            if (currentUser) {
                loginBtn.style.display = 'none';
                logoutBtn.style.display = 'block';
                userInfo.style.display = 'flex';
                userName.textContent = currentUser.name;
                userAvatar.textContent = currentUser.name.charAt(0);
                
                // Mostrar botões de acordo com o perfil do usuário
                if (currentUser.role === 'admin') {
                    adminPanelBtn.style.display = 'block';
                    policePanelBtn.style.display = 'block';
                    detranPanelBtn.style.display = 'block';
                } else if (currentUser.org === 'Policial') {
                    policePanelBtn.style.display = 'block';
                } else if (currentUser.org === 'Detran') {
                    detranPanelBtn.style.display = 'block';
                }
            } else {
                loginBtn.style.display = 'block';
                logoutBtn.style.display = 'none';
                userInfo.style.display = 'none';
                adminPanelBtn.style.display = 'none';
                policePanelBtn.style.display = 'none';
                detranPanelBtn.style.display = 'none';
            }
        }
        
        function showPanel(panel) {
            hideAllPanels();
            currentPanel = panel;
            
            if (panel === 'admin') {
                adminPanel.style.display = 'block';
                loadUsersTable();
                loadAuditTable();
            } else if (panel === 'police') {
                policePanel.style.display = 'block';
                loadIndividualsList();
                updatePoliceDashboard();
            } else if (panel === 'detran') {
                detranPanel.style.display = 'block';
                loadVehiclesList();
                updateDetranDashboard();
            }
        }
        
        function hideAllPanels() {
            adminPanel.style.display = 'none';
            policePanel.style.display = 'none';
            detranPanel.style.display = 'none';
        }
        
        function loadUsersTable() {
            usersTable.innerHTML = '';
            users.forEach(user => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.name}</td>
                    <td>${user.username}</td>
                    <td>${user.org}</td>
                    <td><span class="status-badge ${user.active ? 'status-active' : 'status-inactive'}">${user.active ? 'Ativo' : 'Inativo'}</span></td>
                    <td>
                        <button class="btn btn-primary" onclick="editUser(${user.id})">Editar</button>
                        <button class="btn btn-danger" onclick="deleteUser(${user.id})">Excluir</button>
                    </td>
                `;
                usersTable.appendChild(row);
            });
        }
        
        function loadAuditTable() {
            auditTable.innerHTML = '';
            auditLogs.forEach(log => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${log.username}</td>
                    <td>${log.timestamp}</td>
                    <td>${log.ip}</td>
                    <td>${log.status}</td>
                `;
                auditTable.appendChild(row);
            });
        }
        
        function loadIndividualsList() {
            individualsList.innerHTML = '';
            
            if (individuals.length === 0) {
                individualsList.innerHTML = '<p>Nenhum indivíduo cadastrado.</p>';
                return;
            }
            
            individuals.forEach(individual => {
                const individualCard = document.createElement('div');
                individualCard.className = 'individual-card';
                individualCard.innerHTML = `
                    <div class="individual-photo">
                        ${individual.photo ? `<img src="${individual.photo}" alt="${individual.name}" style="width:100%; height:100%; object-fit:cover; border-radius:8px;">` : 'Sem foto'}
                    </div>
                    <div class="individual-info">
                        <div class="individual-name">${individual.name} ${individual.lastName}</div>
                        <div class="individual-details">
                            <span>CPF: ${individual.cpf}</span>
                            <span>Artigo: ${individual.penalArticle}</span>
                            <span>Prisão: ${individual.prisonTime}</span>
                        </div>
                    </div>
                    <div class="individual-actions">
                        <button class="btn btn-primary" onclick="viewIndividual(${individual.id})">Visualizar</button>
                        <button class="btn btn-danger" onclick="deleteIndividual(${individual.id})">Excluir</button>
                    </div>
                `;
                individualsList.appendChild(individualCard);
            });
        }
        
        function loadVehiclesList() {
            vehiclesList.innerHTML = '';
            
            if (vehicles.length === 0) {
                vehiclesList.innerHTML = '<p>Nenhum veículo registrado.</p>';
                return;
            }
            
            vehicles.forEach(vehicle => {
                const now = new Date();
                const daysRemaining = Math.ceil((vehicle.expiryDate - now) / (1000 * 60 * 60 * 24));
                let statusText = '';
                let statusClass = '';
                
                if (vehicle.regularized) {
                    statusText = 'Regularizado';
                    statusClass = 'status-active';
                } else if (daysRemaining > 0) {
                    statusText = `Pendente (${daysRemaining} dias)`;
                    statusClass = 'status-warning';
                } else {
                    statusText = 'Expirado';
                    statusClass = 'status-inactive';
                }
                
                const vehicleCard = document.createElement('div');
                vehicleCard.className = 'vehicle-card';
                vehicleCard.innerHTML = `
                    <div class="vehicle-photo">
                        ${vehicle.photo ? `<img src="${vehicle.photo}" alt="${vehicle.plate}" style="width:100%; height:100%; object-fit:cover; border-radius:8px;">` : 'Sem foto'}
                    </div>
                    <div class="vehicle-info">
                        <div class="vehicle-plate">${vehicle.plate}</div>
                        <div class="vehicle-details">
                            <span>Proprietário: ${vehicle.owner}</span>
                            <span>Modelo: ${vehicle.model}</span>
                            <span>Cor: ${vehicle.color}</span>
                        </div>
                        <div class="expiry-info">
                            <span>Motivo: ${vehicle.reason}</span>
                            <span class="${daysRemaining <= 3 && !vehicle.regularized ? 'expiry-warning' : ''} ${daysRemaining <= 0 && !vehicle.regularized ? 'expiry-danger' : ''}">
                                Status: ${statusText}
                            </span>
                        </div>
                    </div>
                    <div class="vehicle-actions">
                        <button class="btn btn-success" onclick="regularizeVehicle(${vehicle.id})" ${vehicle.regularized ? 'disabled' : ''}>Regularizar</button>
                        <button class="btn btn-danger" onclick="deleteVehicle(${vehicle.id})">Excluir</button>
                    </div>
                `;
                vehiclesList.appendChild(vehicleCard);
            });
        }
        
        function updatePoliceDashboard() {
            totalIndividuals.textContent = individuals.length;
            
            const totalArrestsCount = individuals.reduce((total, individual) => total + individual.arrests, 0);
            totalArrests.textContent = totalArrestsCount;
        }
        
        function updateDetranDashboard() {
            totalVehicles.textContent = vehicles.length;
            
            const now = new Date();
            const pendingCount = vehicles.filter(v => !v.regularized && v.expiryDate > now).length;
            const expiredCount = vehicles.filter(v => !v.regularized && v.expiryDate <= now).length;
            const regularizedCount = vehicles.filter(v => v.regularized).length;
            
            pendingVehicles.textContent = pendingCount;
            expiredVehicles.textContent = expiredCount;
            regularizedVehicles.textContent = regularizedCount;
        }
        
        function addNewUser() {
            const name = document.getElementById('newUserName').value;
            const username = document.getElementById('newUserUsername').value;
            const password = document.getElementById('newUserPassword').value;
            const org = document.getElementById('newUserOrg').value;
            const role = document.getElementById('newUserRole').value;
            
            // Verificar se o usuário já existe
            if (users.find(u => u.username === username)) {
                alert('Já existe um usuário com este nome de usuário!');
                return;
            }
            
            const newUser = {
                id: users.length + 1,
                name: name,
                username: username,
                password: password,
                org: org,
                role: role,
                active: true
            };
            
            users.push(newUser);
            loadUsersTable();
            addUserModal.style.display = 'none';
            addUserForm.reset();
            
            alert('Usuário cadastrado com sucesso!');
        }
        
        function addNewIndividual() {
            const name = document.getElementById('individualName').value;
            const lastName = document.getElementById('individualLastName').value;
            const cpf = document.getElementById('individualCPF').value;
            const photo = document.getElementById('individualPhoto').value;
            const penalArticle = document.getElementById('individualPenalArticle').value;
            const prisonTime = document.getElementById('individualPrisonTime').value;
            
            // Verificar se o indivíduo já existe
            if (individuals.find(i => i.cpf === cpf)) {
                alert('Já existe um indivíduo cadastrado com este CPF!');
                return;
            }
            
            const newIndividual = {
                id: individuals.length + 1,
                name: name,
                lastName: lastName,
                cpf: cpf,
                photo: photo,
                penalArticle: penalArticle,
                prisonTime: prisonTime,
                criminalRecords: [],
                arrests: 0
            };
            
            individuals.push(newIndividual);
            loadIndividualsList();
            updatePoliceDashboard();
            addIndividualModal.style.display = 'none';
            addIndividualForm.reset();
            photoPreview.textContent = "Pré-visualização da foto";
            
            alert('Indivíduo cadastrado com sucesso!');
        }
        
        function addNewVehicle() {
            const plate = document.getElementById('vehiclePlate').value;
            const owner = document.getElementById('vehicleOwner').value;
            const model = document.getElementById('vehicleModel').value;
            const color = document.getElementById('vehicleColor').value;
            const year = document.getElementById('vehicleYear').value;
            const photo = document.getElementById('vehiclePhoto').value;
            const reason = document.getElementById('vehicleReason').value;
            
            // Verificar se o veículo já existe
            if (vehicles.find(v => v.plate === plate)) {
                alert('Já existe um veículo cadastrado com esta placa!');
                return;
            }
            
            const now = new Date();
            const expiryDate = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000); // 7 dias a partir de hoje
            
            const newVehicle = {
                id: vehicles.length + 1,
                plate: plate,
                owner: owner,
                model: model,
                color: color,
                year: year,
                photo: photo,
                reason: reason,
                registrationDate: now,
                expiryDate: expiryDate,
                regularized: false
            };
            
            vehicles.push(newVehicle);
            loadVehiclesList();
            updateDetranDashboard();
            addVehicleModal.style.display = 'none';
            addVehicleForm.reset();
            
            alert('Veículo registrado com sucesso! O prazo para regularização é de 7 dias.');
        }
        
        function searchVehicle(plate) {
            const vehicle = vehicles.find(v => v.plate === plate);
            
            if (!vehicle) {
                plateResult.innerHTML = '<p style="color: var(--danger-color);">Veículo não encontrado no sistema.</p>';
                return;
            }
            
            const now = new Date();
            const daysRemaining = Math.ceil((vehicle.expiryDate - now) / (1000 * 60 * 60 * 24));
            let statusText = '';
            let statusClass = '';
            
            if (vehicle.regularized) {
                statusText = 'Regularizado';
                statusClass = 'status-active';
            } else if (daysRemaining > 0) {
                statusText = `Pendente de regularização (${daysRemaining} dias restantes)`;
                statusClass = 'status-warning';
            } else {
                statusText = 'Prazo expirado - Não regularizado';
                statusClass = 'status-inactive';
            }
            
            plateResult.innerHTML = `
                <div style="background-color: var(--light-color); padding: 15px; border-radius: 8px;">
                    <h4>Informações do Veículo</h4>
                    <p><strong>Placa:</strong> ${vehicle.plate}</p>
                    <p><strong>Proprietário:</strong> ${vehicle.owner}</p>
                    <p><strong>Modelo:</strong> ${vehicle.model} ${vehicle.year}</p>
                    <p><strong>Cor:</strong> ${vehicle.color}</p>
                    <p><strong>Motivo da Restrição:</strong> ${vehicle.reason}</p>
                    <p><strong>Status:</strong> <span class="${statusClass}">${statusText}</span></p>
                    <p><strong>Data de Registro:</strong> ${vehicle.registrationDate.toLocaleDateString('pt-BR')}</p>
                    <p><strong>Prazo para Regularização:</strong> ${vehicle.expiryDate.toLocaleDateString('pt-BR')}</p>
                </div>
            `;
        }
        
        function regularizeVehicle(id) {
            const vehicle = vehicles.find(v => v.id === id);
            if (vehicle) {
                vehicle.regularized = true;
                loadVehiclesList();
                updateDetranDashboard();
                alert('Veículo regularizado com sucesso!');
            }
        }
        
        function deleteVehicle(id) {
            if (confirm('Tem certeza que deseja excluir este veículo?')) {
                vehicles = vehicles.filter(vehicle => vehicle.id !== id);
                loadVehiclesList();
                updateDetranDashboard();
                alert('Veículo excluído com sucesso!');
            }
        }
        
        function viewIndividual(id) {
            const individual = individuals.find(i => i.id === id);
            if (!individual) return;
            
            individualDetails.innerHTML = `
                <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                    <div class="individual-photo" style="width: 150px; height: 150px;">
                        ${individual.photo ? `<img src="${individual.photo}" alt="${individual.name}" style="width:100%; height:100%; object-fit:cover; border-radius:8px;">` : 'Sem foto'}
                    </div>
                    <div>
                        <h3>${individual.name} ${individual.lastName}</h3>
                        <p><strong>CPF:</strong> ${individual.cpf}</p>
                        <p><strong>Artigo Penal:</strong> ${individual.penalArticle}</p>
                        <p><strong>Tempo de Prisão:</strong> ${individual.prisonTime}</p>
                    </div>
                </div>
                
                <div class="criminal-record">
                    <h4>Histórico Criminal</h4>
                    <p><strong>Total de Passagens:</strong> ${individual.criminalRecords.length}</p>
                    <p><strong>Total de Prisões:</strong> ${individual.arrests}</p>
                    
                    ${individual.criminalRecords.length > 0 ? 
                        individual.criminalRecords.map(record => `
                            <div class="record-item">
                                <div class="record-date">${record.date}</div>
                                <div class="record-description">${record.description}</div>
                            </div>
                        `).join('') : 
                        '<p>Nenhuma passagem criminal registrada.</p>'
                    }
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="btn btn-warning" onclick="addCriminalRecord(${individual.id})">Adicionar Passagem</button>
                    <button class="btn btn-danger" onclick="deleteIndividual(${individual.id})">Excluir Indivíduo</button>
                </div>
            `;
            
            viewIndividualModal.style.display = 'flex';
        }
        
        function addCriminalRecord(individualId) {
            const date = prompt("Data da passagem (DD/MM/AAAA):");
            const description = prompt("Descrição da passagem:");
            
            if (date && description) {
                const individual = individuals.find(i => i.id === individualId);
                if (individual) {
                    individual.criminalRecords.push({
                        date: date,
                        description: description
                    });
                    
                    // Se a descrição contém "Condenado", incrementar o contador de prisões
                    if (description.toLowerCase().includes("condenado")) {
                        individual.arrests++;
                    }
                    
                    viewIndividual(individualId);
                    loadIndividualsList();
                    updatePoliceDashboard();
                }
            }
        }
        
        function deleteIndividual(id) {
            if (confirm('Tem certeza que deseja excluir este indivíduo?')) {
                individuals = individuals.filter(individual => individual.id !== id);
                loadIndividualsList();
                updatePoliceDashboard();
                viewIndividualModal.style.display = 'none';
                alert('Indivíduo excluído com sucesso!');
            }
        }
        
        function editUser(id) {
            alert(`Editar usuário com ID ${id} - Funcionalidade em desenvolvimento`);
        }
        
        function deleteUser(id) {
            if (id === 1) {
                alert('Não é possível excluir o usuário administrador padrão!');
                return;
            }
            
            if (confirm('Tem certeza que deseja excluir este usuário?')) {
                users = users.filter(user => user.id !== id);
                loadUsersTable();
                alert('Usuário excluído com sucesso!');
            }
        }
        
        function generateRandomIP() {
            return `192.168.1.${Math.floor(Math.random() * 255)}`;
        }
        
        // Inicialização
        updateUI();
    </script>
</body>
</html>